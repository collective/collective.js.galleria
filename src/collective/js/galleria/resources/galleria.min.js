!function(t,e){t.Galleria=e(t,t.jQuery)}(window,function(y,b,w,m){function r(){}function P(){return!1}function p(){return{html:x.documentElement,body:x.body,head:x.getElementsByTagName("head")[0],title:x.title}}function s(t){return t.replace("++plone++","\\+\\+plone\\+\\+").replace("++resource++","\\+\\+resource\\+\\+").replace("++theme++","\\+\\+theme\\+\\+")}var l,c,h,u,d,g,f,v,_,i,t,a,o,x=y.document,T=b(x),k=b(y),O=b,U=Array.prototype,I=!0,C=!1,e=navigator.userAgent.toLowerCase(),S=y.location.hash.replace(/#\//,""),n="file:"==y.location.protocol?"http:":y.location.protocol,A=Math,H=!(1279<y.screen.width&&1==y.devicePixelRatio||1e3<y.screen.width&&y.innerWidth<.9*y.screen.width),E=function(){for(var t=3,e=x.createElement("div"),i=e.getElementsByTagName("i");e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e",i[0];);return 4<t?t:x.documentMode||m}(),z=y.parent!==y.self;function D(t,e,i,n){var a,o=this.getOptions("easing"),s=this.getStageWidth(),r={left:s*(t.rewind?-1:1)},l={left:0};i?(r.opacity=0,l.opacity=1):r.opacity=1,b(t.next).css(r),Utils.animate(t.next,l,{duration:t.speed,complete:(a=b(t.next).add(t.prev),function(){e(),a.css({left:0})}),queue:!1,easing:o}),n&&(t.rewind=!t.rewind),t.prev&&(r={left:0},l={left:s*(t.rewind?1:-1)},i&&(r.opacity=1,l.opacity=0),b(t.prev).css(r),Utils.animate(t.prev,l,{duration:t.speed,queue:!1,easing:o,complete:function(){b(this).css("opacity",0)}}))}function L(t,e,i){var n={};i=i||"transition",b.each("webkit moz ms o".split(" "),function(){n["-"+this+"-"+i]=e}),t.css(n)}function F(t){L(t,"none","transition"),w.WEBKIT&&w.TOUCH&&(L(t,"translate3d(0,0,0)","transform"),t.data("revert")&&(t.css(t.data("revert")),t.data("revert",null)))}function $(t,e){var n;this.config={start:0,duration:500,onchange:function(){},oncomplete:function(){},easing:function(t,e,i,n,a){return-n*((e=e/a-1)*e*e*e-1)+i}},this.easeout=function(t,e,i,n,a){return n*((e=e/a-1)*e*e*e*e+1)+i},t.children.length&&(b.extend((n=this).config,e),this.elem=t,this.child=t.children[0],this.to=this.pos=0,this.touching=!1,this.start={},this.index=this.config.start,this.anim=0,this.easing=this.config.easing,a||(this.child.style.position="absolute",this.elem.style.position="relative"),b.each(["ontouchstart","ontouchmove","ontouchend","setup"],function(t,e){var i;n[e]=(i=n[e],function(){i.apply(n,arguments)})}),this.setX=function(){var t=n.child.style;a?t.MozTransform=t.webkitTransform=t.transform="translate3d("+n.pos+"px,0,0)":t.left=n.pos+"px"},b(t).on("touchstart",this.ontouchstart),b(y).on("resize",this.setup),b(y).on("orientationchange",this.setup),this.setup(),function t(){o(t),n.loop.call(n)}())}return _eventlist="data ready thumbnail loadstart loadfinish image play pause progress fullscreen_enter fullscreen_exit idle_enter idle_exit rescale lightbox_open lightbox_close lightbox_image",_events=(i=[],b.each(_eventlist.split(" "),function(t,e){i.push(e),/_/.test(e)&&i.push(e.replace(/_/g,""))}),i),_legacyOptions=function(i){var n;return"object"!=typeof i||b.each(i,function(t,e){/^[a-z]+_/.test(t)&&(n="",b.each(t.split("_"),function(t,e){n+=0<t?e.substr(0,1).toUpperCase()+e.substr(1):e}),i[n]=e,delete i[t])}),i},_patchEvent=function(t){return-1<b.inArray(t,_events)?w[t.toUpperCase()]:t},_video={youtube:{reg:/https?:\/\/(?:[a-zA_Z]{2,3}.)?(?:youtube\.com\/watch\?)((?:[\w\d\-\_\=]+&amp;(?:amp;)?)*v(?:&lt;[A-Z]+&gt;)?=([0-9a-zA-Z\-\_]+))/i,embed:function(){return n+"//www.youtube.com/embed/"+this.id},get_thumb:function(t){return n+"//img.youtube.com/vi/"+this.id+"/default.jpg"},get_image:function(t){return n+"//img.youtube.com/vi/"+this.id+"/maxresdefault.jpg"}},vimeo:{reg:/https?:\/\/(?:www\.)?(vimeo\.com)\/(?:hd#)?([0-9]+)/i,embed:function(){return n+"//player.vimeo.com/video/"+this.id},getUrl:function(){return n+"//vimeo.com/api/v2/video/"+this.id+".json?callback=?"},get_thumb:function(t){return t[0].thumbnail_medium},get_image:function(t){return t[0].thumbnail_large}},dailymotion:{reg:/https?:\/\/(?:www\.)?(dailymotion\.com)\/video\/([^_]+)/,embed:function(){return n+"//www.dailymotion.com/embed/video/"+this.id},getUrl:function(){return"https://api.dailymotion.com/video/"+this.id+"?fields=thumbnail_240_url,thumbnail_720_url&callback=?"},get_thumb:function(t){return t.thumbnail_240_url},get_image:function(t){return t.thumbnail_720_url}},_inst:[]},Video=function(t,e){for(var i=0;i<_video._inst.length;i++)if(_video._inst[i].id===e&&_video._inst[i].type==t)return _video._inst[i];this.type=t,this.id=e,this.readys=[],_video._inst.push(this);var n=this;b.extend(this,_video[t]),_videoThumbs=function(t){n.data=t,b.each(n.readys,function(t,e){e(n.data)}),n.readys=[]},this.hasOwnProperty("getUrl")?b.getJSON(this.getUrl(),_videoThumbs):y.setTimeout(_videoThumbs,400),this.getMedia=function(e,i,n){n=n||r;function t(t){i(a["get_"+e](t))}var a=this;try{a.data?t(a.data):a.readys.push(t)}catch(t){n()}}},_videoTest=function(t){var e,i;for(i in _video)if((e=t&&_video[i].reg&&t.match(_video[i].reg))&&e.length)return{id:e[2],provider:i};return!1},_nativeFullscreen={support:(t=p().html,!z&&(t.requestFullscreen||t.msRequestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen)),callback:r,enter:function(t,e,i){this.instance=t,this.callback=e||r,(i=i||p().html).requestFullscreen?i.requestFullscreen():i.msRequestFullscreen?i.msRequestFullscreen():i.mozRequestFullScreen?i.mozRequestFullScreen():i.webkitRequestFullScreen&&i.webkitRequestFullScreen()},exit:function(t){this.callback=t||r,x.exitFullscreen?x.exitFullscreen():x.msExitFullscreen?x.msExitFullscreen():x.mozCancelFullScreen?x.mozCancelFullScreen():x.webkitCancelFullScreen&&x.webkitCancelFullScreen()},instance:null,listen:function(){var t;this.support&&(x.addEventListener("fullscreenchange",t=function(){var t;_nativeFullscreen.instance&&(t=_nativeFullscreen.instance._fullscreen,x.fullscreen||x.mozFullScreen||x.webkitIsFullScreen||x.msFullscreenElement&&null!==x.msFullscreenElement?t._enter(_nativeFullscreen.callback):t._exit(_nativeFullscreen.callback))},!1),x.addEventListener("MSFullscreenChange",t,!1),x.addEventListener("mozfullscreenchange",t,!1),x.addEventListener("webkitfullscreenchange",t,!1))}},_galleries=[],_instances=[],_hasError=!1,_canvas=!1,_pool=[],_loadedThemes=[],_themeLoad=function(i){_loadedThemes.push(i),b.each(_pool,function(t,e){e._options.theme!=i.name&&(e._initialized||e._options.theme)||(e.theme=i,e._init.call(e))})},Utils={clearTimer:function(t){b.each(w.get(),function(){this.clearTimer(t)})},addTimer:function(t){b.each(w.get(),function(){this.addTimer(t)})},array:function(t){return U.slice.call(t,0)},create:function(t,e){e=x.createElement(e=e||"div");return e.className=t,e},removeFromArray:function(i,n){return b.each(i,function(t,e){if(e==n)return i.splice(t,1),!1}),i},getScriptPath:function(t){t=(t=t||b("script:last").attr("src")).split("/");return 1==t.length?"":(t.pop(),t.join("/")+"/")},animate:(f=function(t){var e,i="transition WebkitTransition MozTransition OTransition".split(" ");if(y.opera)return!1;for(e=0;i[e];e++)if(void 0!==t[i[e]])return i[e];return!1}((x.body||x.documentElement).style),v={MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[f],function(i,t,e){if(e=b.extend({duration:400,complete:r,stop:!1},e),i=b(i),!e.duration)return i.css(t),void e.complete.call(i[0]);var n,a,o,s;f?(e.stop&&(i.off(v),F(i)),l=!1,b.each(t,function(t,e){g=i.css(t),Utils.parseValue(g)!=Utils.parseValue(e)&&(l=!0),i.css(t,g)}),l?(c=[],h=e.easing in _?_[e.easing]:_._default,h=" "+e.duration+"ms cubic-bezier("+h.join(",")+")",y.setTimeout((n=i,a=v,o=t,s=h,function(){var t;n.one(a,(t=n,function(){F(t),e.complete.call(t[0])})),w.WEBKIT&&w.TOUCH&&(u={},d=[0,0,0],b.each(["left","top"],function(t,e){e in o&&(d[t]=Utils.parseValue(o[e])-Utils.parseValue(n.css(e))+"px",u[e]=o[e],delete o[e])}),(d[0]||d[1])&&(n.data("revert",u),c.push("-webkit-transform"+s),L(n,"translate3d("+d.join(",")+")","transform"))),b.each(o,function(t,e){c.push(t+s)}),L(n,c.join(",")),n.css(o)}),2)):y.setTimeout(function(){e.complete.call(i[0])},e.duration)):i.animate(t,e)}),removeAlpha:function(t){var e;t instanceof O&&(t=t[0]),E<9&&t&&(e=t.style,t=(t=t.currentStyle)&&t.filter||e.filter||"",/alpha/.test(t)&&(e.filter=t.replace(/alpha\([^)]*\)/i,"")))},forceStyles:function(t,e){(t=b(t)).attr("style")&&t.data("styles",t.attr("style")).removeAttr("style"),t.css(e)},revertStyles:function(){b.each(Utils.array(arguments),function(t,e){(e=b(e)).removeAttr("style"),e.attr("style",""),e.data("styles")&&e.attr("style",e.data("styles")).data("styles",null)})},moveOut:function(t){Utils.forceStyles(t,{position:"absolute",left:-1e4})},moveIn:function(){Utils.revertStyles.apply(Utils,Utils.array(arguments))},hide:function(t,e,i){i=i||r;var n,a=b(t),o=(t=a[0],a.data("opacity")||a.data("opacity",a.css("opacity")),{opacity:0});e?(n=E<9&&t?function(){Utils.removeAlpha(t),t.style.visibility="hidden",i.call(t)}:i,Utils.animate(t,o,{duration:e,complete:n,stop:!0})):E<9&&t?(Utils.removeAlpha(t),t.style.visibility="hidden"):a.css(o)},show:function(t,e,i){i=i||r;var n=b(t);t=n[0];var a,o={opacity:parseFloat(n.data("opacity"))||1};e?(E<9&&(n.css("opacity",0),t.style.visibility="visible"),a=E<9&&t?function(){1==o.opacity&&Utils.removeAlpha(t),i.call(t)}:i,Utils.animate(t,o,{duration:e,complete:a,stop:!0})):E<9&&1==o.opacity&&t?(Utils.removeAlpha(t),t.style.visibility="visible"):n.css(o)},wait:function(t){w._waiters=w._waiters||[],t=b.extend({until:P,success:r,error:function(){w.raise("Could not complete wait function.")},timeout:3e3},t);function e(){return n=Utils.timestamp(),i=n-o,Utils.removeFromArray(w._waiters,a),t.until(i)?(t.success(),!1):"number"==typeof t.timeout&&n>=o+t.timeout?(t.error(),!1):void w._waiters.push(a=y.setTimeout(e,10))}var i,n,a,o=Utils.timestamp();w._waiters.push(a=y.setTimeout(e,10))},toggleQuality:function(t,e){7!==E&&8!==E||!t||"IMG"!=t.nodeName.toUpperCase()||(void 0===e&&(e="nearest-neighbor"===t.style.msInterpolationMode),t.style.msInterpolationMode=e?"bicubic":"nearest-neighbor")},insertStyleTag:function(t,e){var i;e&&b("#"+e).length||(i=x.createElement("style"),e&&(i.id=e),p().head.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:(e=x.createTextNode(t),i.appendChild(e)))},loadScript:function(t,e){var i=!1,n=b("<script>").attr({src:t,async:!0}).get(0);n.onload=n.onreadystatechange=function(){i||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(i=!0,n.onload=n.onreadystatechange=null,"function"==typeof e&&e.call(this,this))},p().head.appendChild(n)},parseValue:function(t){return"number"==typeof t?t:"string"==typeof t&&(t=t.match(/\-?\d|\./g))&&t.constructor===Array?+t.join(""):0},timestamp:function(){return(new Date).getTime()},loadCSS:function(t,e,i){var n,a;if(b("link[rel=stylesheet]").each(function(){if(new RegExp(s(t)).test(this.href))return o=this,!1}),"function"==typeof e&&(i=e,e=m),i=i||r,o)return i.call(o,o),o;if(n=x.styleSheets.length,b("#"+e).length)b("#"+e).attr("href",t),n--;else{var o=b("<link>").attr({rel:"stylesheet",href:t,id:e}).get(0),e=b('link[rel="stylesheet"], style');if(e.length?e.get(0).parentNode.insertBefore(o,e[0]):p().head.appendChild(o),E&&31<=n)return void w.raise("You have reached the browser stylesheet limit (31)",!0)}return"function"==typeof i&&(a=b("<s>").attr("id","galleria-loader").hide().appendTo(p().body),Utils.wait({until:function(){return 0<a.height()},success:function(){a.remove(),i.call(o,o)},error:function(){a.remove(),w.raise("Theme CSS could not load after 20 sec. "+(w.QUIRK?"Your browser is in Quirks Mode, please add a correct doctype.":"Please download the latest theme."),!0)},timeout:5e3})),o}},_playIcon=function(t){return Utils.insertStyleTag(".galleria-videoicon{width:60px;height:60px;position:absolute;top:50%;left:50%;z-index:1;margin:-30px 0 0 -30px;cursor:pointer;background:#000;background:rgba(0,0,0,.8);border-radius:3px;-webkit-transition:all 150ms}.galleria-videoicon i{width:0px;height:0px;border-style:solid;border-width:10px 0 10px 16px;display:block;border-color:transparent transparent transparent #ffffff;margin:20px 0 0 22px}.galleria-image:hover .galleria-videoicon{background:#000}","galleria-videoicon"),b(Utils.create("galleria-videoicon")).html("<i></i>").appendTo(t).click(function(){b(this).siblings("img").mouseup()})},_transitions={active:!(_={_default:[.25,.1,.25,1],galleria:[.645,.045,.355,1],galleriaIn:[.55,.085,.68,.53],galleriaOut:[.25,.46,.45,.94],ease:[.25,0,.25,1],linear:[.25,.25,.75,.75],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]}),init:function(t,e,i){_transitions.effects.hasOwnProperty(t)&&_transitions.effects[t].call(this,e,i)},effects:{fade:function(t,e){b(t.next).css({opacity:0,left:0}),Utils.animate(t.next,{opacity:1},{duration:t.speed,complete:e}),t.prev&&(b(t.prev).css("opacity",1).show(),Utils.animate(t.prev,{opacity:0},{duration:t.speed}))},flash:function(t,e){b(t.next).css({opacity:0,left:0}),t.prev?Utils.animate(t.prev,{opacity:0},{duration:t.speed/2,complete:function(){Utils.animate(t.next,{opacity:1},{duration:t.speed,complete:e})}}):Utils.animate(t.next,{opacity:1},{duration:t.speed,complete:e})},pulse:function(t,e){t.prev&&b(t.prev).hide(),b(t.next).css({opacity:0,left:0}).show(),Utils.animate(t.next,{opacity:1},{duration:t.speed,complete:e})},slide:function(t,e){D.apply(this,Utils.array(arguments))},fadeslide:function(t,e){D.apply(this,Utils.array(arguments).concat([!0]))},doorslide:function(t,e){D.apply(this,Utils.array(arguments).concat([!1,!0]))}}},_nativeFullscreen.listen(),b.event.special["click:fast"]={propagate:!0,add:function(i){function n(t){if(t.touches&&t.touches.length)return{x:(t=t.touches[0]).pageX,y:t.pageY}}var a={touched:!1,touchdown:!1,coords:{x:0,y:0},evObj:{}};b(this).data({clickstate:a,timer:0}).on("touchstart.fast",function(t){y.clearTimeout(b(this).data("timer")),b(this).data("clickstate",{touched:!0,touchdown:!0,coords:n(t.originalEvent),evObj:t})}).on("touchmove.fast",function(t){var t=n(t.originalEvent),e=b(this).data("clickstate");6<Math.max(Math.abs(e.coords.x-t.x),Math.abs(e.coords.y-t.y))&&b(this).data("clickstate",b.extend(e,{touchdown:!1}))}).on("touchend.fast",function(t){var e=b(this);e.data("clickstate").touchdown&&i.handler.call(this,t),e.data("timer",y.setTimeout(function(){e.data("clickstate",a)},400))}).on("click.fast",function(t){if(b(this).data("clickstate").touched)return!1;b(this).data("clickstate",a),i.handler.call(this,t)})},remove:function(){b(this).off("touchstart.fast touchmove.fast touchend.fast click.fast")}},k.on("orientationchange",function(){b(this).resize()}),(w=function(){var u=this,n=(this._options={},this._playing=!1,this._playtime=5e3,this._active=null,this._queue={length:0},this._data=[],this._dom={},this._thumbnails=[],this._layers=[],this._initialized=!1,this._firstrun=!1,this._stageWidth=0,this._stageHeight=0,this._target=m,this._binds=[],this._id=parseInt(1e4*A.random(),10),b.each("container stage images image-nav image-nav-left image-nav-right info info-text info-title info-description thumbnails thumbnails-list thumbnails-container thumb-nav-left thumb-nav-right loader counter tooltip".split(" "),function(t,e){u._dom[e]=Utils.create("galleria-"+e)}),b.each("current total".split(" "),function(t,e){u._dom[e]=Utils.create("galleria-"+e,"span")}),this._keyboard={keys:{UP:38,DOWN:40,LEFT:37,RIGHT:39,RETURN:13,ESCAPE:27,BACKSPACE:8,SPACE:32},map:{},bound:!1,press:function(t){var e=t.keyCode||t.which;e in n.map&&"function"==typeof n.map[e]&&n.map[e].call(u,t)},attach:function(t){var e,i;for(e in t)t.hasOwnProperty(e)&&((i=e.toUpperCase())in n.keys?n.map[n.keys[i]]=t[e]:n.map[i]=t[e]);n.bound||(n.bound=!0,T.on("keydown",n.press))},detach:function(){n.bound=!1,n.map={},T.off("keydown",n.press)}}),t=this._controls={0:m,1:m,active:0,swap:function(){t.active=t.active?0:1},getActive:function(){return u._options.swipe?t.slides[u._active]:t[t.active]},getNext:function(){return u._options.swipe?t.slides[u.getNext(u._active)]:t[1-t.active]},slides:[],frames:[],layers:[]},i=this._carousel={next:u.$("thumb-nav-right"),prev:u.$("thumb-nav-left"),width:0,current:0,max:0,hooks:[],update:function(){var n=0,a=0,o=[0];b.each(u._thumbnails,function(t,e){var i;e.ready&&(n+=e.outerWidth||b(e.container).outerWidth(!0),i=b(e.container).width(),n+=i-A.floor(i),o[t+1]=n,a=A.max(a,e.outerHeight||b(e.container).outerHeight(!0)))}),u.$("thumbnails").css({width:n,height:a}),i.max=n,i.hooks=o,i.width=u.$("thumbnails-list").width(),i.setClasses(),u.$("thumbnails-container").toggleClass("galleria-carousel",n>i.width),i.width=u.$("thumbnails-list").width()},bindControls:function(){var e;i.next.on("click:fast",function(t){if(t.preventDefault(),"auto"===u._options.carouselSteps){for(e=i.current;e<i.hooks.length;e++)if(i.hooks[e]-i.hooks[i.current]>i.width){i.set(e-2);break}}else i.set(i.current+u._options.carouselSteps)}),i.prev.on("click:fast",function(t){if(t.preventDefault(),"auto"===u._options.carouselSteps)for(e=i.current;0<=e;e--){if(i.hooks[i.current]-i.hooks[e]>i.width){i.set(e+2);break}if(0===e){i.set(0);break}}else i.set(i.current-u._options.carouselSteps)})},set:function(t){for(t=A.max(t,0);i.hooks[t-1]+i.width>=i.max&&0<=t;)t--;i.current=t,i.animate()},getLast:function(t){return(t||i.current)-1},follow:function(t){if(0===t||t===i.hooks.length-2)i.set(t);else{for(var e=i.current;i.hooks[e]-i.hooks[i.current]<i.width&&e<=i.hooks.length;)e++;t-1<i.current?i.set(t-1):e<t+2&&i.set(t-e+i.current+2)}},setClasses:function(){i.prev.toggleClass("disabled",!i.current),i.next.toggleClass("disabled",i.hooks[i.current]+i.width>=i.max)},animate:function(t){i.setClasses();var e=-1*i.hooks[i.current];isNaN(e)||(u.$("thumbnails").css("left",function(){return b(this).css("left")}),Utils.animate(u.get("thumbnails"),{left:e},{duration:u._options.carouselSpeed,easing:u._options.easing,queue:!1}))}},a=this._tooltip={initialized:!1,open:!1,timer:"tooltip"+u._id,swapTimer:"swap"+u._id,init:function(){a.initialized=!0;Utils.insertStyleTag(".galleria-tooltip{padding:3px 8px;max-width:50%;background:#ffe;color:#000;z-index:3;position:absolute;font-size:11px;line-height:1.3;opacity:0;box-shadow:0 0 2px rgba(0,0,0,.4);-moz-box-shadow:0 0 2px rgba(0,0,0,.4);-webkit-box-shadow:0 0 2px rgba(0,0,0,.4);}","galleria-tooltip"),u.$("tooltip").css({opacity:.8,visibility:"visible",display:"none"})},move:function(t){var e=u.getMousePosition(t).x,t=u.getMousePosition(t).y,i=u.$("tooltip"),n=t,a=i.outerHeight(!0)+1,o=i.outerWidth(!0),s=a+15,o=u.$("container").width()-o-2,r=u.$("container").height()-a-2;isNaN(e)||isNaN(n)||(n-=a+8,e=A.max(0,A.min(o,e+=10)),n=A.max(0,A.min(r,n)),i.css({left:e,top:n=t<s?s:n}))},bind:function(t,e){var i,n;w.TOUCH||(a.initialized||a.init(),i=function(){u.$("container").off("mousemove",a.move),u.clearTimer(a.timer),u.$("tooltip").stop().animate({opacity:0},200,function(){u.$("tooltip").hide(),u.addTimer(a.swapTimer,function(){a.open=!1},1e3)})},n=function(t,e){a.define(t,e),b(t).hover(function(){u.clearTimer(a.swapTimer),u.$("container").off("mousemove",a.move).on("mousemove",a.move).trigger("mousemove"),a.show(t),u.addTimer(a.timer,function(){u.$("tooltip").stop().show().animate({opacity:1}),a.open=!0},a.open?0:500)},i).click(i)},"string"==typeof e?n(t in u._dom?u.get(t):t,e):b.each(t,function(t,e){n(u.get(t),e)}))},show:function(i){var t=(i=b(i in u._dom?u.get(i):i)).data("tt"),n=function(t){var e;y.setTimeout((e=t,function(){a.move(e)}),10),i.off("mouseup",n)};(t="function"==typeof t?t():t)&&(u.$("tooltip").html(t.replace(/\s/,"&#160;")),i.on("mouseup",n))},define:function(t,e){var i;"function"!=typeof e&&(i=e,e=function(){return i}),t=b(t in u._dom?u.get(t):t).data("tt",e),a.show(t)}},d=this._fullscreen={scrolled:0,crop:m,active:!1,prev:b(),beforeEnter:function(t){t()},beforeExit:function(t){t()},keymap:u._keyboard.map,parseCallback:function(i,n){return _transitions.active?function(){"function"==typeof i&&i.call(u);var t=u._controls.getActive(),e=u._controls.getNext();u._scaleImage(e),u._scaleImage(t),n&&u._options.trueFullscreen&&b(t.container).add(e.container).trigger("transitionend")}:i},enter:function(t){d.beforeEnter(function(){t=d.parseCallback(t,!0),u._options.trueFullscreen&&_nativeFullscreen.support?(d.active=!0,Utils.forceStyles(u.get("container"),{width:"100%",height:"100%"}),u.rescale(),w.MAC?w.SAFARI&&/version\/[1-5]/.test(e)?(u.$("stage").css("opacity",0),y.setTimeout(function(){d.scale(),u.$("stage").css("opacity",1)},4)):(u.$("container").css("opacity",0).addClass("fullscreen"),y.setTimeout(function(){d.scale(),u.$("container").css("opacity",1)},50)):u.$("container").addClass("fullscreen"),k.resize(d.scale),_nativeFullscreen.enter(u,t,u.get("container"))):(d.scrolled=k.scrollTop(),w.TOUCH||y.scrollTo(0,0),d._enter(t))})},_enter:function(t){d.active=!0,z&&(d.iframe=(r=x.referrer,l=x.createElement("a"),h=y.location,l.href=r,l.protocol!=h.protocol||l.hostname!=h.hostname||l.port!=h.port?(w.raise("Parent fullscreen not available. Iframe protocol, domains and ports must match."),!1):(d.pd=y.parent.document,b(d.pd).find("iframe").each(function(){if((this.contentDocument||this.contentWindow.document)===x)return e=this,!1}),e))),Utils.hide(u.getActiveImage()),z&&d.iframe&&(d.iframe.scrolled=b(y.parent).scrollTop(),y.parent.scrollTo(0,0));var e,i,n,a,o,s,r=u.getData(),l=u._options,c=!u._options.trueFullscreen||!_nativeFullscreen.support,h={height:"100%",overflow:"hidden",margin:0,padding:0};c&&(u.$("container").addClass("fullscreen"),d.prev=u.$("container").prev(),d.prev.length||(d.parent=u.$("container").parent()),u.$("container").appendTo("body"),Utils.forceStyles(u.get("container"),{position:w.TOUCH?"absolute":"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1e4}),Utils.forceStyles(p().html,h),Utils.forceStyles(p().body,h)),z&&d.iframe&&(Utils.forceStyles(d.pd.documentElement,h),Utils.forceStyles(d.pd.body,h),Utils.forceStyles(d.iframe,b.extend(h,{width:"100%",height:"100%",top:0,left:0,position:"fixed",zIndex:1e4,border:"none"}))),d.keymap=b.extend({},u._keyboard.map),u.attachKeyboard({escape:u.exitFullscreen,right:u.next,left:u.prev}),d.crop=l.imageCrop,l.fullscreenCrop!=m&&(l.imageCrop=l.fullscreenCrop),r&&r.big&&r.image!==r.big&&(s=new w.Picture,i=s.isCached(r.big),n=u.getIndex(),a=u._thumbnails[n],u.trigger({type:w.LOADSTART,cached:i,rewind:!1,index:n,imageTarget:u.getActiveImage(),thumbTarget:a,galleriaData:r}),s.load(r.big,function(t){u._scaleImage(t,{complete:function(t){u.trigger({type:w.LOADFINISH,cached:i,index:n,rewind:!1,imageTarget:t.image,thumbTarget:a});var e=u._controls.getActive().image;e&&(b(e).width(t.image.width).height(t.image.height).attr("style",b(t.image).attr("style")),t.image.src.srcset&&b(e).attr("srcset",t.image.src.srcset),t.image.src.sizes&&b(e).attr("sizes",t.image.src.sizes),b(e).attr("src",t.image.src))}})}),s=u.getNext(n),o=new w.Picture,s=u.getData(s),o.preload(u.isFullscreen()&&s.big?s.big:s.image)),u.rescale(function(){u.addTimer(!1,function(){c&&Utils.show(u.getActiveImage()),"function"==typeof t&&t.call(u),u.rescale()},100),u.trigger(w.FULLSCREEN_ENTER)}),c?k.resize(d.scale):Utils.show(u.getActiveImage())},scale:function(){u.rescale()},exit:function(t){d.beforeExit(function(){t=d.parseCallback(t),u._options.trueFullscreen&&_nativeFullscreen.support?_nativeFullscreen.exit(t):d._exit(t)})},_exit:function(t){d.active=!1;var e,i=!u._options.trueFullscreen||!_nativeFullscreen.support,n=u.$("container").removeClass("fullscreen"),n=(d.parent?d.parent.prepend(n):n.insertAfter(d.prev),i&&(Utils.hide(u.getActiveImage()),Utils.revertStyles(u.get("container"),p().html,p().body),w.TOUCH||y.scrollTo(0,d.scrolled),(n=u._controls.frames[u._controls.active])&&n.image&&(n.image.src=n.image.src)),z&&d.iframe&&(Utils.revertStyles(d.pd.documentElement,d.pd.body,d.iframe),d.iframe.scrolled&&y.parent.scrollTo(0,d.iframe.scrolled)),u.detachKeyboard(),u.attachKeyboard(d.keymap),u._options.imageCrop=d.crop,u.getData().big),a=u._controls.getActive().image;!u.getData().iframe&&a&&n&&n==a.src&&y.setTimeout((e=u.getData().image,function(){a.src=e}),1),u.rescale(function(){u.addTimer(!1,function(){i&&Utils.show(u.getActiveImage()),"function"==typeof t&&t.call(u),k.trigger("resize")},50),u.trigger(w.FULLSCREEN_EXIT)}),k.off("resize",d.scale)}},s=this._idle={trunk:[],bound:!1,active:!1,add:function(t,e,i,n){if(t&&!w.TOUCH){s.bound||s.addEvent(),t=b(t),"boolean"==typeof i&&(n=i,i={}),i=i||{};var a,o={};for(a in e)e.hasOwnProperty(a)&&(o[a]=t.css(a));t.data("idle",{from:b.extend(o,i),to:e,complete:!0,busy:!1}),n?t.css(e):s.addTimer(),s.trunk.push(t)}},remove:function(i){i=b(i),b.each(s.trunk,function(t,e){e&&e.length&&!e.not(i).length&&(i.css(i.data("idle").from),s.trunk.splice(t,1))}),s.trunk.length||(s.removeEvent(),u.clearTimer(s.timer))},addEvent:function(){s.bound=!0,u.$("container").on("mousemove click",s.showAll),"hover"==u._options.idleMode&&u.$("container").on("mouseleave",s.hide)},removeEvent:function(){s.bound=!1,u.$("container").on("mousemove click",s.showAll),"hover"==u._options.idleMode&&u.$("container").off("mouseleave",s.hide)},addTimer:function(){"hover"!=u._options.idleMode&&u.addTimer("idle",function(){s.hide()},u._options.idleTime)},hide:function(){var n;u._options.idleMode&&!1!==u.getIndex()&&(u.trigger(w.IDLE_ENTER),n=s.trunk.length,b.each(s.trunk,function(t,e){var i=e.data("idle");i&&(e.data("idle").complete=!1,Utils.animate(e,i.to,{duration:u._options.idleSpeed,complete:function(){t==n-1&&(s.active=!1)}}))}))},showAll:function(){u.clearTimer("idle"),b.each(s.trunk,function(t,e){s.show(e)})},show:function(t){var e=t.data("idle");s.active&&(e.busy||e.complete)||(e.busy=!0,u.trigger(w.IDLE_EXIT),u.clearTimer("idle"),Utils.animate(t,e.from,{duration:u._options.idleSpeed/2,complete:function(){s.active=!0,b(t).data("idle").busy=!1,b(t).data("idle").complete=!0}})),s.addTimer()}},h=this._lightbox={width:0,height:0,initialized:!1,active:null,image:null,elems:{},keymap:!1,init:function(){var a,i,n,t,o,e;h.initialized||(h.initialized=!0,a={},t=u._options,i="",n="lightbox-",t={overlay:"position:fixed;display:none;opacity:"+t.overlayOpacity+";filter:alpha(opacity="+100*t.overlayOpacity+");top:0;left:0;width:100%;height:100%;background:"+t.overlayBackground+";z-index:99990",box:"position:fixed;display:none;width:400px;height:400px;top:50%;left:50%;margin-top:-200px;margin-left:-200px;z-index:99991",shadow:(t="position:absolute;")+"background:#000;width:100%;height:100%;",content:t+"background-color:#fff;top:10px;left:10px;right:10px;bottom:10px;overflow:hidden",info:t+"bottom:10px;left:10px;right:10px;color:#444;font:11px/13px arial,sans-serif;height:13px",close:t+"top:10px;right:10px;height:20px;width:20px;background:#fff;text-align:center;cursor:pointer;color:#444;font:16px/22px arial,sans-serif;z-index:99999",image:t+"top:10px;left:10px;right:10px;bottom:30px;overflow:hidden;display:block;",prevholder:t+"width:50%;top:0;bottom:40px;cursor:pointer;",nextholder:t+"width:50%;top:0;bottom:40px;right:-1px;cursor:pointer;",prev:t+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;left:20px;display:none;text-align:center;color:#000;font:bold 16px/36px arial,sans-serif",next:t+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;right:20px;left:auto;display:none;font:bold 16px/36px arial,sans-serif;text-align:center;color:#000",title:"float:left",counter:"float:right;margin-left:8px;"},o={},e="",t.nextholder+=e=7<E?E<9?"background:#000;filter:alpha(opacity=0);":"background:rgba(0,0,0,0);":"z-index:99999",t.prevholder+=e,b.each(t,function(t,e){i+=".galleria-"+n+t+"{"+e+"}"}),i+=".galleria-"+n+"box.iframe .galleria-"+n+"prevholder,.galleria-"+n+"box.iframe .galleria-"+n+"nextholder{width:100px;height:100px;top:50%;margin-top:-70px}",Utils.insertStyleTag(i,"galleria-lightbox"),b.each("overlay box content shadow title info close prevholder prev nextholder next counter image".split(" "),function(t,e){u.addElement("lightbox-"+e),a[e]=h.elems[e]=u.get("lightbox-"+e)}),h.image=new w.Picture,b.each({box:"shadow content close prevholder nextholder",info:"title counter",content:"info image",prevholder:"prev",nextholder:"next"},function(t,e){var i=[];b.each(e.split(" "),function(t,e){i.push(n+e)}),o[n+t]=i}),u.append(o),b(a.image).append(h.image.container),b(p().body).append(a.overlay,a.box),b(a.close).on("click:fast",h.hide).html("&#215;").hover(function(){b(this).css("color","#bbb")},function(){b(this).css("color","#444")}),b.each(["Prev","Next"],function(t,e){var i=b(a[e.toLowerCase()]).html(/v/.test(e)?"&#8249;&#160;":"&#160;&#8250;"),n=b(a[e.toLowerCase()+"holder"]);n.on("click:fast",function(){h["show"+e]()}),E<8||w.TOUCH?i.show():n.hover(function(){i.show()},function(t){i.stop().fadeOut(200)})}),b(a.overlay).on("click:fast",h.hide),w.IPAD&&(u._options.lightboxTransitionSpeed=0))},rescale:function(t){var e=A.min(k.width()-40,h.width),i=A.min(k.height()-60,h.height),e=A.min(e/h.width,i/h.height),i=A.round(h.width*e)+40,e=A.round(h.height*e)+60,e={width:i,height:e,"margin-top":-1*A.ceil(e/2),"margin-left":-1*A.ceil(i/2)};t?b(h.elems.box).css(e):b(h.elems.box).animate(e,{duration:u._options.lightboxTransitionSpeed,easing:u._options.easing,complete:function(){var t=h.image,e=u._options.lightboxFadeSpeed;u.trigger({type:w.LIGHTBOX_IMAGE,imageTarget:t.image}),b(t.container).show(),b(t.image).animate({opacity:1},e),Utils.show(h.elems.info,e)}})},hide:function(){h.image.image=null,k.off("resize",h.rescale),b(h.elems.box).hide().find("iframe").remove(),Utils.hide(h.elems.info),u.detachKeyboard(),u.attachKeyboard(h.keymap),h.keymap=!1,Utils.hide(h.elems.overlay,200,function(){b(this).hide().css("opacity",u._options.overlayOpacity),u.trigger(w.LIGHTBOX_CLOSE)})},showNext:function(){h.show(u.getNext(h.active))},showPrev:function(){h.show(u.getPrev(h.active))},show:function(r){h.active=r="number"==typeof r?r:u.getIndex()||0,h.initialized||h.init(),u.trigger(w.LIGHTBOX_OPEN),h.keymap||(h.keymap=b.extend({},u._keyboard.map),u.attachKeyboard({escape:h.hide,right:h.showNext,left:h.showPrev})),k.off("resize",h.rescale);var t,e,i,l=u.getData(r),c=u.getDataLength(),n=u.getNext(r);Utils.hide(h.elems.info);try{for(i=u._options.preload;0<i;i--)e=new w.Picture,t=u.getData(n),e.preload(t.big||t.image),n=u.getNext(n)}catch(t){}h.image.isIframe=l.iframe&&!l.image,b(h.elems.box).toggleClass("iframe",h.image.isIframe),b(h.image.container).find(".galleria-videoicon").remove(),h.image.load(l.big||l.image||l.iframe,function(t){var e,i,n,a,o,s;t.isIframe?(e=b(y).width(),i=b(y).height(),t.video&&u._options.maxVideoSize&&((n=A.min(u._options.maxVideoSize/e,u._options.maxVideoSize/i))<1&&(e*=n,i*=n)),h.width=e,h.height=i):(h.width=t.original.width,h.height=t.original.height),b(t.image).css({width:t.isIframe?"100%":"100.1%",height:t.isIframe?"100%":"100.1%",top:0,bottom:0,zIndex:99998,opacity:0,visibility:"visible"}).parent().height("100%"),h.elems.title.innerHTML=l.title||"",h.elems.counter.innerHTML=r+1+" / "+c,k.resize(h.rescale),h.rescale(),l.image&&l.iframe&&(b(h.elems.box).addClass("iframe"),l.video&&(a=_playIcon(t.container).hide(),y.setTimeout(function(){a.fadeIn(200)},200)),b(t.image).css("cursor","pointer").mouseup((o=l,s=t,function(t){b(h.image.container).find(".galleria-videoicon").remove(),t.preventDefault(),s.isIframe=!0,s.load(o.iframe+(o.video?"&autoplay=1":""),{width:"100%",height:E<8?b(h.image.container).height():"100%"})})))}),b(h.elems.overlay).show().css("visibility","visible"),b(h.elems.box).show()}},o=this._timer={trunk:{},add:function(t,e,i,n){var a;t=t||(new Date).getTime(),n=n||!1,this.clear(t),n&&(a=e,e=function(){a(),o.add(t,e,i)}),this.trunk[t]=y.setTimeout(e,i)},clear:function(t){function e(t){y.clearTimeout(this.trunk[t]),delete this.trunk[t]}if(t&&t in this.trunk)e.call(this,t);else if(void 0===t)for(var i in this.trunk)this.trunk.hasOwnProperty(i)&&e.call(this,i)}};return this}).prototype={constructor:w,init:function(t,e){if(e=_legacyOptions(e),this._original={target:t,options:e,data:null},this._target=this._dom.target=t.nodeName?t:b(t).get(0),this._original.html=this._target.innerHTML,_instances.push(this),this._target){if(this._options={autoplay:!1,carousel:!0,carouselFollow:!0,carouselSpeed:400,carouselSteps:"auto",clicknext:!1,dailymotion:{foreground:"%23EEEEEE",highlight:"%235BCEC5",background:"%23222222",logo:0,hideInfos:1},dataConfig:function(t){return{}},dataSelector:"img",dataSort:!1,dataSource:this._target,debug:m,dummy:m,easing:"galleria",extend:function(t){},fullscreenCrop:m,fullscreenDoubleTap:!0,fullscreenTransition:m,height:0,idleMode:!0,idleTime:3e3,idleSpeed:200,imageCrop:!1,imageMargin:0,imagePan:!1,imagePanSmoothness:12,imagePosition:"50%",imageTimeout:m,initialTransition:m,keepSource:!1,layerFollow:!0,lightbox:!1,lightboxFadeSpeed:200,lightboxTransitionSpeed:200,linkSourceImages:!0,maxScaleRatio:m,maxVideoSize:m,minScaleRatio:m,overlayOpacity:.85,overlayBackground:"#0b0b0b",pauseOnInteraction:!0,popupLinks:!1,preload:2,queue:!0,responsive:!0,show:0,showInfo:!0,showCounter:!0,showImagenav:!0,swipe:"auto",theme:null,thumbCrop:!0,thumbEventType:"click:fast",thumbMargin:0,thumbQuality:"auto",thumbDisplayOrder:!0,thumbPosition:"50%",thumbnails:!0,touchTransition:m,transition:"fade",transitionInitial:m,transitionSpeed:400,trueFullscreen:!0,useCanvas:!1,variation:"",videoPoster:!0,vimeo:{title:0,byline:0,portrait:0,color:"aaaaaa"},wait:5e3,width:"auto",youtube:{modestbranding:1,autohide:1,color:"white",hd:1,rel:0,showinfo:0}},this._options.initialTransition=this._options.initialTransition||this._options.transitionInitial,e&&(!1===e.debug&&(I=!1),"number"==typeof e.imageTimeout&&e.imageTimeout,"string"==typeof e.dummy&&(C=e.dummy),"string"==typeof e.theme&&(this._options.theme=e.theme)),b(this._target).children().hide(),w.QUIRK&&w.raise("Your page is in Quirks mode, Galleria may not render correctly. Please validate your HTML and add a correct doctype."),_loadedThemes.length)if(this._options.theme){for(var i=0;i<_loadedThemes.length;i++)if(this._options.theme===_loadedThemes[i].name){this.theme=_loadedThemes[i];break}}else this.theme=_loadedThemes[0];return"object"==typeof this.theme?this._init():_pool.push(this),this}w.raise("Target not found",!0)},_init:function(){var t,e,i,n,a,o,s,r,l,c=this,h=this._options;return this._initialized?(w.raise("Init failed: Gallery instance already initialized."),this):(this._initialized=!0,this.theme?(b.extend(!0,h,this.theme.defaults,this._original.options,w.configure.options),h.swipe="enforced"==(t=h.swipe)||!1!==t&&"disabled"!=t&&!!w.TOUCH,h.swipe&&(h.clicknext=!1,h.imagePan=!1),"getContext"in(t=x.createElement("canvas"))?_canvas=_canvas||{elem:t,context:t.getContext("2d"),cache:{},length:0}:t=null,this.bind(w.DATA,function(){y.screen&&y.screen.width&&Array.prototype.forEach&&this._data.forEach(function(t){var e="devicePixelRatio"in y?y.devicePixelRatio:1;A.max(y.screen.width,y.screen.height)*e<1024&&(t.big=t.image)}),this._original.data=this._data,this.get("total").innerHTML=this.getDataLength();function t(){return c.$("stage").height()}var e=this.$("container"),i=(c._options.height<2&&(c._userRatio=c._ratio=c._options.height),{width:0,height:0});Utils.wait({until:function(){return i=c._getWH(),e.width(i.width).height(i.height),t()&&i.width&&50<i.height},success:function(){c._width=i.width,c._height=i.height,c._ratio=c._ratio||i.height/i.width,w.WEBKIT?y.setTimeout(function(){c._run()},1):c._run()},error:function(){t()?w.raise("Could not extract sufficient width/height of the gallery container. Traced measures: width:"+i.width+"px, height: "+i.height+"px.",!0):w.raise("Could not extract a stage height from the CSS. Traced height: "+t()+"px.",!0)},timeout:"number"==typeof this._options.wait&&this._options.wait})}),this.append({"info-text":["info-title","info-description"],info:["info-text"],"image-nav":["image-nav-right","image-nav-left"],stage:["images","loader","counter","image-nav"],"thumbnails-list":["thumbnails"],"thumbnails-container":["thumb-nav-left","thumbnails-list","thumb-nav-right"],container:["stage","thumbnails-container","info","tooltip"]}),Utils.hide(this.$("counter").append(this.get("current"),x.createTextNode(" / "),this.get("total"))),this.setCounter("&#8211;"),Utils.hide(c.get("tooltip")),this.$("container").addClass([w.TOUCH?"touch":"notouch",this._options.variation,"galleria-theme-"+this.theme.name].join(" ")),this._options.swipe||b.each(new Array(2),function(t){var e=new w.Picture,i=(b(e.container).css({position:"absolute",top:0,left:0}).prepend(c._layers[t]=b(Utils.create("galleria-layer")).css({position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2})[0]),c.$("images").append(e.container),c._controls[t]=e,new w.Picture);i.isIframe=!0,b(i.container).attr("class","galleria-frame").css({position:"absolute",top:0,left:0,zIndex:4,background:"#000",display:"none"}).appendTo(e.container),c._controls.frames[t]=i}),this.$("images").css({position:"relative",top:0,left:0,width:"100%",height:"100%"}),h.swipe&&(this.$("images").css({position:"absolute",top:0,left:0,width:0,height:"100%"}),this.finger=new w.Finger(this.get("stage"),{onchange:function(t){c.pause().show(t)},oncomplete:function(t){var t=A.max(0,A.min(parseInt(t,10),c.getDataLength()-1)),e=c.getData(t);b(c._thumbnails[t].container).addClass("active").siblings(".active").removeClass("active"),e&&(c.$("images").find(".galleria-frame").css("opacity",0).hide().find("iframe").remove(),c._options.carousel&&c._options.carouselFollow&&c._carousel.follow(t))}}),this.bind(w.RESCALE,function(){this.finger.setup()}),this.$("stage").on("click",function(t){var e,i,n,a=c.getData();if(a)return a.iframe?(c.isPlaying()&&c.pause(),e=c._controls.frames[c._active],i=c._stageWidth,n=c._stageHeight,b(e.container).find("iframe").length?void 0:(b(e.container).css({width:i,height:n,opacity:0}).show().animate({opacity:1},200),void y.setTimeout(function(){e.load(a.iframe+(a.video?"&autoplay=1":""),{width:i,height:n},function(t){c.$("container").addClass("videoplay"),t.scale({width:c._stageWidth,height:c._stageHeight,iframelimit:a.video?c._options.maxVideoSize:m})})},100))):void(a.link&&(c._options.popupLinks?y.open(a.link,"_blank"):y.location.href=a.link))}),this.bind(w.IMAGE,function(t){c.setCounter(t.index),c.setInfo(t.index);var t=this.getNext(),e=this.getPrev(),i=[e,t],n=(i.push(this.getNext(t),this.getPrev(e),c._controls.slides.length-1),[]);b.each(i,function(t,e){-1==b.inArray(e,n)&&n.push(e)}),b.each(n,function(t,e){var i=c.getData(e),n=c._controls.slides[e],a=c.isFullscreen()&&i.big?i.big:i.image||i.iframe;i.iframe&&!i.image&&(n.isIframe=!0),n.ready||c._controls.slides[e].load(a,function(t){t.isIframe||b(t.image).css("visibility","hidden"),c._scaleImage(t,{complete:function(t){t.isIframe||b(t.image).css({opacity:0,visibility:"visible"}).animate({opacity:1},200)}})})})})),this.$("thumbnails, thumbnails-list").css({overflow:"hidden",position:"relative"}),this.$("image-nav-right, image-nav-left").on("click:fast",function(t){h.pauseOnInteraction&&c.pause();var e=/right/.test(this.className)?"next":"prev";c[e]()}).on("click",function(t){t.preventDefault(),(h.clicknext||h.swipe)&&t.stopPropagation()}),b.each(["info","counter","image-nav"],function(t,e){!1===h["show"+e.substr(0,1).toUpperCase()+e.substr(1).replace(/-/,"")]&&Utils.moveOut(c.get(e.toLowerCase()))}),this.load(),h.keepSource||E||(this._target.innerHTML=""),this.get("errors")&&this.appendChild("target","errors"),this.appendChild("target","container"),h.carousel&&(e=0,i=h.show,this.bind(w.THUMBNAIL,function(){this.updateCarousel(),++e==this.getDataLength()&&"number"==typeof i&&0<i&&this._carousel.follow(i)})),h.responsive&&k.on("resize",function(){c.isFullscreen()||c.resize()}),h.fullscreenDoubleTap&&this.$("stage").on("touchstart",(c.$("stage").on("touchmove",function(){n=0}),function(t){if(!/(-left|-right)/.test(t.target.className)){if(l=Utils.timestamp(),a=u(t).pageX,o=u(t).pageY,t.originalEvent.touches.length<2&&l-n<300&&a-s<20&&o-r<20)return c.toggleFullscreen(),void t.preventDefault();n=l,s=a,r=o}})),b.each(w.on.binds,function(t,e){-1==b.inArray(e.hash,c._binds)&&c.bind(e.type,e.callback)})):w.raise("Init failed: No theme found.",!0),this);function u(t){return t.originalEvent.touches?t.originalEvent.touches[0]:t}},addTimer:function(){return this._timer.add.apply(this._timer,Utils.array(arguments)),this},clearTimer:function(){return this._timer.clear.apply(this._timer,Utils.array(arguments)),this},_getWH:function(){var i,n=this.$("container"),a=this.$("target"),o=this,s={};return b.each(["width","height"],function(t,e){o._options[e]&&"number"==typeof o._options[e]?s[e]=o._options[e]:(i=[Utils.parseValue(n.css(e)),Utils.parseValue(a.css(e)),n[e](),a[e]()],o["_"+e]||i.splice(i.length,Utils.parseValue(n.css("min-"+e)),Utils.parseValue(a.css("min-"+e))),s[e]=A.max.apply(A,i))}),o._userRatio&&(s.height=s.width*o._userRatio),s},_createThumbnails:function(t){this.get("total").innerHTML=this.getDataLength();function e(t){return x.defaultView&&x.defaultView.getComputedStyle?x.defaultView.getComputedStyle(o.container,null)[t]:r.css(t)}function i(t){h.pauseOnInteraction&&c.pause();var e=b(t.currentTarget).data("index");c.getIndex()!==e&&c.show(e),t.preventDefault()}function n(t,s){t.scale({width:t.data.width,height:t.data.height,crop:h.thumbCrop,margin:h.thumbMargin,canvas:h.useCanvas,position:h.thumbPosition,complete:function(i){var n,a,o=["left","top"];c.getData(i.index);b.each(["Width","Height"],function(t,e){n=e.toLowerCase(),!0===h.thumbCrop&&h.thumbCrop!==n||((a={})[n]=i[n],b(i.container).css(a),(a={})[o[t]]=0,b(i.image).css(a)),i["outer"+e]=b(i.container)["outer"+e](!0)}),Utils.toggleQuality(i.image,!0===h.thumbQuality||"auto"===h.thumbQuality&&i.original.width<3*i.width),h.thumbDisplayOrder&&!i.lazy?b.each(p,function(t,e){t===g&&e.ready&&!e.displayed&&(g++,e.displayed=!0,_(e,s))}):_(i,s)}})}var a,o,s,r,l,c=this,h=this._options,u=t?this._data.length-t.length:0,d=u,p=[],g=0,m=E<8?"http://upload.wikimedia.org/wikipedia/commons/c/c0/Blank.gif":"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw%3D%3D",f=!!(l=c.$("thumbnails").find(".active")).length&&l.find("img").attr("src"),v="string"==typeof h.thumbnails?h.thumbnails.toLowerCase():null,_=function(t,e){b(t.container).css("visibility","visible"),c.trigger({type:w.THUMBNAIL,thumbTarget:t.image,index:t.data.order,galleriaData:c.getData(t.data.order)}),"function"==typeof e&&e.call(c,t)};for(t||(this._thumbnails=[],this.$("thumbnails").empty());this._data[u];u++)a=(s=this._data[u]).thumb||s.image,!0!==h.thumbnails&&"lazy"!=v||!s.thumb&&!s.image?s.iframe&&null!==v||"empty"===v||"numbers"===v?(o={container:Utils.create("galleria-image"),image:Utils.create("img","span"),ready:!0,data:{order:u}},"numbers"===v&&b(o.image).text(u+1),s.iframe&&b(o.image).addClass("iframe"),this.$("thumbnails").append(o.container),y.setTimeout(function(t,e,i){return function(){b(i).append(t),c.trigger({type:w.THUMBNAIL,thumbTarget:t,index:e,galleriaData:c.getData(e)})}}(o.image,u,o.container),50+20*u)):o={container:null,image:null}:((o=new w.Picture(u)).index=u,o.displayed=!1,o.lazy=!1,o.video=!1,this.$("thumbnails").append(o.container),(r=b(o.container)).css("visibility","hidden"),o.data={width:Utils.parseValue(e("width")),height:Utils.parseValue(e("height")),order:u,src:a},!0!==h.thumbCrop?r.css({width:"auto",height:"auto"}):r.css({width:o.data.width,height:o.data.height}),"lazy"==v?(r.addClass("lazy"),o.lazy=!0,o.load(m,{height:o.data.height,width:o.data.width})):o.load(a,n),"all"===h.preload&&o.preload(s.image)),b(o.container).add(h.keepSource&&h.linkSourceImages?s.original:null).data("index",u).on(h.thumbEventType,i).data("thumbload",n),f===a&&b(o.container).addClass("active"),this._thumbnails.push(o);return p=this._thumbnails.slice(d),this},lazyLoad:function(t,o){var s=t.constructor==Array?t:[t],r=this,l=0;return b.each(s,function(t,e){var i,n,a;e>r._thumbnails.length-1||(i=(e=r._thumbnails[e]).data,n=function(){++l==s.length&&"function"==typeof o&&o.call(r)},(a=b(e.container).data("thumbload"))&&(e.video?a.call(r,e,n):e.load(i.src,function(t){a.call(r,t,n)})))}),this},lazyLoadChunks:function(t,i){var e=this.getDataLength(),n=0,a=0,o=[],s=[],r=this;for(i=i||0;n<e;n++)s.push(n),++a!=t&&n!=e-1||(o.push(s),a=0,s=[]);var l=function(t){var e=o.shift();e&&y.setTimeout(function(){r.lazyLoad(e,function(){l(!0)})},i&&t?i:0)};return l(!1),this},_run:function(){var a=this;a._createThumbnails(),Utils.wait({timeout:1e4,until:function(){return w.OPERA&&a.$("stage").css("display","inline-block"),a._stageWidth=a.$("stage").width(),a._stageHeight=a.$("stage").height(),a._stageWidth&&50<a._stageHeight},success:function(){var n;if(_galleries.push(a),a._options.swipe&&(n=a.$("images").width(a.getDataLength()*a._stageWidth),b.each(new Array(a.getDataLength()),function(t){var e=new w.Picture,i=a.getData(t),t=(b(e.container).css({position:"absolute",top:0,left:a._stageWidth*t}).prepend(a._layers[t]=b(Utils.create("galleria-layer")).css({position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2})[0]).appendTo(n),i.video&&_playIcon(e.container),a._controls.slides.push(e),new w.Picture);t.isIframe=!0,b(t.container).attr("class","galleria-frame").css({position:"absolute",top:0,left:0,zIndex:4,background:"#000",display:"none"}).appendTo(e.container),a._controls.frames.push(t)}),a.finger.setup()),Utils.show(a.get("counter")),a._options.carousel&&a._carousel.bindControls(),a._options.autoplay&&(a.pause(),"number"==typeof a._options.autoplay&&(a._playtime=a._options.autoplay),a._playing=!0),a._firstrun)return a._options.autoplay&&a.trigger(w.PLAY),void("number"==typeof a._options.show&&a.show(a._options.show));a._firstrun=!0,w.History&&w.History.change(function(t){isNaN(t)?y.history.go(-1):a.show(t,m,!0)}),a.trigger(w.READY),a.theme.init.call(a,a._options),b.each(w.ready.callbacks,function(t,e){"function"==typeof e&&e.call(a,a._options)}),a._options.extend.call(a,a._options),/^[0-9]{1,4}$/.test(S)&&w.History?a.show(S,m,!0):a._data[a._options.show]&&a.show(a._options.show),a._options.autoplay&&a.trigger(w.PLAY)},error:function(){w.raise("Stage width or height is too small to show the gallery. Traced measures: width:"+a._stageWidth+"px, height: "+a._stageHeight+"px.",!0)}})},load:function(t,e,s){var r=this,i=this._options;return this._data=[],this._thumbnails=[],this.$("thumbnails").empty(),"function"==typeof e&&(s=e,e=null),t=t||i.dataSource,e=e||i.dataSelector,s=s||i.dataConfig,b.isPlainObject(t)&&(t=[t]),b.isArray(t)?this.validate(t)?this._data=t:w.raise("Load failed: JSON Array not valid."):(e+=",.video,.iframe",b(t).find(e).each(function(t,i){i=b(i);var n={},e=i.parent(),a=e.attr("href"),o=e.attr("rel");a&&("IMG"==i[0].nodeName||i.hasClass("video"))&&_videoTest(a)?n.video=a:a&&i.hasClass("iframe")?n.iframe=a:n.image=a,o&&(n.big=o),n.imagesrcset=e.data("srcset"),n.imagesizes=e.data("sizes"),n.thumbsizes=i.attr("sizes"),n.thumbsrcset=i.attr("srcset"),b.each("big bigsrcset bigsizes title description link layer image imagesrcset imagesizes".split(" "),function(t,e){i.data(e)&&(n[e]=i.data(e).toString())}),i.data("srcset")&&(n.imagesrcset=i.data("srcset")),i.data("sizes")&&(n.imagesizes=i.data("sizes")),n.big||(n.big=n.image,n.bigsrcset=n.imagesrcset,n.bigsizes=n.imagesizes),r._data.push(b.extend({title:i.attr("title")||"",thumb:i.attr("src"),image:i.attr("src"),big:i.attr("src"),description:i.attr("alt")||"",link:i.attr("longdesc"),original:i.get(0)},n,s(i)))})),"function"==typeof i.dataSort?U.sort.call(this._data,i.dataSort):"random"==i.dataSort&&this._data.sort(function(){return A.round(A.random())-.5}),this.getDataLength()&&this._parseData(function(){this.trigger(w.DATA)}),this},_parseData:function(t){function s(){var i=!0;b.each(l._data,function(t,e){if(e.loading)return i=!1}),i&&!e&&(e=!0,t.call(l))}var r,l=this,e=!1;return b.each(this._data,function(t,i){var o,n;r=l._data[t],b.each("big image thumb".split(" "),function(t,e){i[e]&&(i[e]=new String(i[e]),i[e].srcset=i[e+"srcset"],i[e].sizes=i[e+"sizes"])}),"thumb"in i==!1&&(r.thumb=i.image),i.big||(r.big=i.image),"video"in i&&((o=_videoTest(i.video))&&(r.iframe=new Video(o.provider,o.id).embed()+("object"==typeof l._options[o.provider]?(n=[],b.each(l._options[o.provider],function(t,e){n.push(t+"="+e)}),"?"+(n="youtube"==o.provider?["wmode=opaque"].concat(n):n).join("&")):""),r.thumb&&r.image||b.each(["thumb","image"],function(t,e){var i,n,a;"image"!=e||l._options.videoPoster?(i=new Video(o.provider,o.id),r[e]||(r.loading=!0,i.getMedia(e,(n=r,a=e,function(t){n[a]=t,"image"!=a||n.big||(n.big=n.image),delete n.loading,s()})))):r.image=m})))}),s(),this},destroy:function(){return this.$("target").data("galleria",null),this.$("container").off("galleria"),this.get("target").innerHTML=this._original.html,this.clearTimer(),Utils.removeFromArray(_instances,this),Utils.removeFromArray(_galleries,this),_video._inst=[],void 0!==w._waiters&&w._waiters.length&&b.each(w._waiters,function(t,e){e&&y.clearTimeout(e)}),this},splice:function(){var t=this,e=Utils.array(arguments);return y.setTimeout(function(){U.splice.apply(t._data,e),t._parseData(function(){t._createThumbnails()})},2),t},push:function(){var t=this,e=Utils.array(arguments);return 1==e.length&&e[0].constructor==Array&&(e=e[0]),y.setTimeout(function(){U.push.apply(t._data,e),t._parseData(function(){t._createThumbnails(e)})},2),t},_getActive:function(){return this._controls.getActive()},validate:function(t){return!0},bind:function(t,e){return t=_patchEvent(t),this.$("container").on(t,this.proxy(e)),this},unbind:function(t){return t=_patchEvent(t),this.$("container").off(t),this},trigger:function(t){return t="object"==typeof t?b.extend(t,{scope:this}):{type:_patchEvent(t),scope:this},this.$("container").trigger(t),this},addIdleState:function(t,e,i,n){return this._idle.add.apply(this._idle,Utils.array(arguments)),this},removeIdleState:function(t){return this._idle.remove.apply(this._idle,Utils.array(arguments)),this},enterIdleMode:function(){return this._idle.hide(),this},exitIdleMode:function(){return this._idle.showAll(),this},enterFullscreen:function(t){return this._fullscreen.enter.apply(this,Utils.array(arguments)),this},exitFullscreen:function(t){return this._fullscreen.exit.apply(this,Utils.array(arguments)),this},toggleFullscreen:function(t){return this._fullscreen[this.isFullscreen()?"exit":"enter"].apply(this,Utils.array(arguments)),this},bindTooltip:function(t,e){return this._tooltip.bind.apply(this._tooltip,Utils.array(arguments)),this},defineTooltip:function(t,e){return this._tooltip.define.apply(this._tooltip,Utils.array(arguments)),this},refreshTooltip:function(t){return this._tooltip.show.apply(this._tooltip,Utils.array(arguments)),this},openLightbox:function(){return this._lightbox.show.apply(this._lightbox,Utils.array(arguments)),this},closeLightbox:function(){return this._lightbox.hide.apply(this._lightbox,Utils.array(arguments)),this},hasVariation:function(t){return-1<b.inArray(t,this._options.variation.split(/\s+/))},getActiveImage:function(){var t=this._getActive();return t?t.image:m},getActiveThumb:function(){return this._thumbnails[this._active].image||m},getMousePosition:function(t){return{x:t.pageX-this.$("container").offset().left,y:t.pageY-this.$("container").offset().top}},addPan:function(n){var e,i,a,o,s,r,l,c,h,u,d,p,g,m,t;if(!1!==this._options.imageCrop)return n=b(n||this.getActiveImage()),e=this,i=n.width()/2,a=n.height()/2,o=parseInt(n.css("left"),10),s=parseInt(n.css("top"),10),r=o||0,l=s||0,c=0,h=0,u=!1,d=Utils.timestamp(),p=0,g=0,m=function(t,e,i){0<t&&(g=A.round(A.max(-1*t,A.min(0,e))),p!==g&&(p=g,8===E?n.parent()["scroll"+i](-1*g):((t={})[i.toLowerCase()]=g,n.css(t))))},t=function(t){Utils.timestamp()-d<50||(u=!0,i=e.getMousePosition(t).x,a=e.getMousePosition(t).y)},8===E&&(n.parent().scrollTop(-1*l).scrollLeft(-1*r),n.css({top:0,left:0})),this.$("stage").off("mousemove",t).on("mousemove",t),this.addTimer("pan"+e._id,function(t){u&&(c=n.width()-e._stageWidth,h=n.height()-e._stageHeight,o=i/e._stageWidth*c*-1,s=a/e._stageHeight*h*-1,r+=(o-r)/e._options.imagePanSmoothness,l+=(s-l)/e._options.imagePanSmoothness,m(h,l,"Top"),m(c,r,"Left"))},50,!0),this},proxy:function(t,e){return"function"!=typeof t?r:(e=e||this,function(){return t.apply(e,Utils.array(arguments))})},getThemeName:function(){return this.theme.name},removePan:function(){return this.$("stage").off("mousemove"),this.clearTimer("pan"+this._id),this},addElement:function(t){var i=this._dom;return b.each(Utils.array(arguments),function(t,e){i[e]=Utils.create("galleria-"+e)}),this},attachKeyboard:function(t){return this._keyboard.attach.apply(this._keyboard,Utils.array(arguments)),this},detachKeyboard:function(){return this._keyboard.detach.apply(this._keyboard,Utils.array(arguments)),this},appendChild:function(t,e){return this.$(t).append(this.get(e)||e),this},prependChild:function(t,e){return this.$(t).prepend(this.get(e)||e),this},remove:function(t){return this.$(Utils.array(arguments).join(",")).remove(),this},append:function(t){var e,i;for(e in t)if(t.hasOwnProperty(e))if(t[e].constructor===Array)for(i=0;t[e][i];i++)this.appendChild(e,t[e][i]);else this.appendChild(e,t[e]);return this},_scaleImage:function(t,e){var i,n;if(t=t||this._controls.getActive())return n=function(t){b(t.container).children(":first").css({top:A.max(0,Utils.parseValue(t.image.style.top)),left:A.max(0,Utils.parseValue(t.image.style.left)),width:Utils.parseValue(t.image.width),height:Utils.parseValue(t.image.height)})},e=b.extend({width:this._stageWidth,height:this._stageHeight,crop:this._options.imageCrop,max:this._options.maxScaleRatio,min:this._options.minScaleRatio,margin:this._options.imageMargin,position:this._options.imagePosition,iframelimit:this._options.maxVideoSize},e),this._options.layerFollow&&!0!==this._options.imageCrop?"function"==typeof e.complete?(i=e.complete,e.complete=function(){i.call(t,t),n(t)}):e.complete=n:b(t.container).children(":first").css({top:0,left:0}),t.scale(e),this},updateCarousel:function(){return this._carousel.update(),this},resize:function(i,t){"function"==typeof i&&(t=i,i=m),i=b.extend({width:0,height:0},i);var n=this,a=this.$("container");return b.each(i,function(t,e){e||(a[t]("auto"),i[t]=n._getWH()[t])}),b.each(i,function(t,e){a[t](e)}),this.rescale(t)},rescale:function(t,e,i){var n=this;"function"==typeof t&&(i=t,t=m);return function(){n._stageWidth=t||n.$("stage").width(),n._stageHeight=e||n.$("stage").height(),n._options.swipe?(b.each(n._controls.slides,function(t,e){n._scaleImage(e),b(e.container).css("left",n._stageWidth*t)}),n.$("images").css("width",n._stageWidth*n.getDataLength())):n._scaleImage(),n._options.carousel&&n.updateCarousel(),n._controls.frames[n._controls.active]&&n._controls.frames[n._controls.active].scale({width:n._stageWidth,height:n._stageHeight,iframelimit:n._options.maxVideoSize}),n.trigger(w.RESCALE),"function"==typeof i&&i.call(n)}.call(n),this},refreshImage:function(){return this._scaleImage(),this._options.imagePan&&this.addPan(),this},_preload:function(){if(this._options.preload){var t,e,i,n=this.getNext();try{for(e=this._options.preload;0<e;e--)t=new w.Picture,i=this.getData(n),t.preload(this.isFullscreen()&&i.big?i.big:i.image),n=this.getNext(n)}catch(t){}}},show:function(t,e,i){var n=this._options.swipe;if(n||!(3<this._queue.length||!1===t||!this._options.queue&&this._queue.stalled)){if(t=A.max(0,A.min(parseInt(t,10),this.getDataLength()-1)),e=void 0!==e?!!e:t<this.getIndex(),(i=i||!1)||!w.History){if(this.finger&&t!==this._active&&(this.finger.to=-(t*this.finger.width),this.finger.index=t),this._active=t,n){var a=this.getData(t),o=this;if(!a)return;function s(){o._layers[t].innerHTML=o.getData().layer||"",o.trigger(b.extend(c,{type:w.LOADFINISH})),o._playCheck()}var r=this.isFullscreen()&&a.big?a.big:a.image||a.iframe,l=this._controls.slides[t],i=l.isCached(r),n=this._thumbnails[t],c={cached:i,index:t,rewind:e,imageTarget:l.image,thumbTarget:n.image,galleriaData:a};this.trigger(b.extend(c,{type:w.LOADSTART})),o.$("container").removeClass("videoplay");o._preload(),y.setTimeout(function(){l.ready&&b(l.image).attr("src")==r?(o.trigger(b.extend(c,{type:w.IMAGE})),s()):(a.iframe&&!a.image&&(l.isIframe=!0),l.load(r,function(t){c.imageTarget=t.image,o._scaleImage(t,s).trigger(b.extend(c,{type:w.IMAGE})),s()}))},100)}else U.push.call(this._queue,{index:t,rewind:e}),this._queue.stalled||this._show();return this}w.History.set(t.toString())}},_show:function(){var t,a,e,o,i,s,r,l,n,c,h,u,d=this,p=this._queue[0],g=this.getData(p.index);g&&(t=this.isFullscreen()&&g.big?g.big:g.image||g.iframe,a=this._controls.getActive(),e=this._controls.getNext(),o=e.isCached(t),i=this._thumbnails[p.index],s=function(){b(e.image).trigger("mouseup")},d.$("container").toggleClass("iframe",!!g.isIframe).removeClass("videoplay"),l=g,n=e,c=a,h=p,u=i,r=function(){_transitions.active=!1,Utils.toggleQuality(n.image,d._options.imageQuality),d._layers[d._controls.active].innerHTML="",b(c.container).css({zIndex:0,opacity:0}).show(),b(c.container).find("iframe, .galleria-videoicon").remove(),b(d._controls.frames[d._controls.active].container).hide(),b(n.container).css({zIndex:1,left:0,top:0}).show(),d._controls.swap(),d._options.imagePan&&d.addPan(n.image),(l.iframe&&l.image||l.link||d._options.lightbox||d._options.clicknext)&&b(n.image).css({cursor:"pointer"}).on("mouseup",function(t){var e,i,n;if(!("number"==typeof t.which&&1<t.which))return l.iframe?(d.isPlaying()&&d.pause(),e=d._controls.frames[d._controls.active],i=d._stageWidth,n=d._stageHeight,b(e.container).css({width:i,height:n,opacity:0}).show().animate({opacity:1},200),void y.setTimeout(function(){e.load(l.iframe+(l.video?"&autoplay=1":""),{width:i,height:n},function(t){d.$("container").addClass("videoplay"),t.scale({width:d._stageWidth,height:d._stageHeight,iframelimit:l.video?d._options.maxVideoSize:m})})},100)):d._options.clicknext&&!w.TOUCH?(d._options.pauseOnInteraction&&d.pause(),void d.next()):void(l.link?d._options.popupLinks?y.open(l.link,"_blank"):y.location.href=l.link:d._options.lightbox&&d.openLightbox())}),d._playCheck(),d.trigger({type:w.IMAGE,index:h.index,imageTarget:n.image,thumbTarget:u.image,galleriaData:l}),U.shift.call(d._queue),d._queue.stalled=!1,d._queue.length&&d._show()},this._options.carousel&&this._options.carouselFollow&&this._carousel.follow(p.index),d._preload(),Utils.show(e.container),e.isIframe=g.iframe&&!g.image,b(d._thumbnails[p.index].container).addClass("active").siblings(".active").removeClass("active"),d.trigger({type:w.LOADSTART,cached:o,index:p.index,rewind:p.rewind,imageTarget:e.image,thumbTarget:i.image,galleriaData:g}),d._queue.stalled=!0,e.load(t,function(t){var n=b(d._layers[1-d._controls.active]).html(g.layer||"").hide();d._scaleImage(t,{complete:function(t){"image"in a&&Utils.toggleQuality(a.image,!1),Utils.toggleQuality(t.image,!1),d.removePan(),d.setInfo(p.index),d.setCounter(p.index),g.layer&&(n.show(),(g.iframe&&g.image||g.link||d._options.lightbox||d._options.clicknext)&&n.css("cursor","pointer").off("mouseup").mouseup(s)),g.video&&g.image&&_playIcon(t.container);var e,i=d._options.transition;b.each({initial:null===a.image,touch:w.TOUCH,fullscreen:d.isFullscreen()},function(t,e){if(e&&d._options[t+"Transition"]!==m)return i=d._options[t+"Transition"],!1}),i in _transitions.effects==!1?r():(e={prev:a.container,next:t.container,rewind:p.rewind,speed:d._options.transitionSpeed||400},_transitions.active=!0,_transitions.init.call(d,i,e,r)),d.trigger({type:w.LOADFINISH,cached:o,index:p.index,rewind:p.rewind,imageTarget:t.image,thumbTarget:d._thumbnails[p.index].image,galleriaData:d.getData(p.index)})}})}))},getNext:function(t){return(t="number"==typeof t?t:this.getIndex())===this.getDataLength()-1?0:t+1},getPrev:function(t){return 0===(t="number"==typeof t?t:this.getIndex())?this.getDataLength()-1:t-1},next:function(){return 1<this.getDataLength()&&this.show(this.getNext(),!1),this},prev:function(){return 1<this.getDataLength()&&this.show(this.getPrev(),!0),this},get:function(t){return t in this._dom?this._dom[t]:null},getData:function(t){return t in this._data?this._data[t]:this._data[this._active]},getDataLength:function(){return this._data.length},getIndex:function(){return"number"==typeof this._active&&this._active},getStageHeight:function(){return this._stageHeight},getStageWidth:function(){return this._stageWidth},getOptions:function(t){return void 0===t?this._options:this._options[t]},setOptions:function(t,e){return"object"==typeof t?b.extend(this._options,t):this._options[t]=e,this},play:function(t){return this._playing=!0,this._playtime=t||this._playtime,this._playCheck(),this.trigger(w.PLAY),this},pause:function(){return this._playing=!1,this.trigger(w.PAUSE),this},playToggle:function(t){return this._playing?this.pause():this.play(t)},isPlaying:function(){return this._playing},isFullscreen:function(){return this._fullscreen.active},_playCheck:function(){var t,e=this,i=0,n=20,a=Utils.timestamp(),o="play"+this._id;this._playing&&(this.clearTimer(o),t=function(){if((i=Utils.timestamp()-a)>=e._playtime&&e._playing)return e.clearTimer(o),void e.next();e._playing&&(e.trigger({type:w.PROGRESS,percent:A.ceil(i/e._playtime*100),seconds:A.floor(i/1e3),milliseconds:i}),e.addTimer(o,t,n))},e.addTimer(o,t,n))},setPlaytime:function(t){return this._playtime=t,this},setIndex:function(t){return this._active=t,this},setCounter:function(t){var e;return"number"==typeof t?t++:void 0===t&&(t=this.getIndex()+1),this.get("current").innerHTML=t,E&&(e=(t=this.$("counter")).css("opacity"),1===parseInt(e,10)?Utils.removeAlpha(t[0]):this.$("counter").css("opacity",e)),this},setInfo:function(t){var n=this,a=this.getData(t);return b.each(["title","description"],function(t,e){var i=n.$("info-"+e);a[e]?i[a[e].length?"show":"hide"]().html(a[e]):i.empty().hide()}),this},hasInfo:function(t){for(var e="title description".split(" "),i=0;e[i];i++)if(this.getData(t)[e[i]])return!0;return!1},jQuery:function(t){var i=this,n=[],a=(b.each(t.split(","),function(t,e){e=b.trim(e),i.get(e)&&n.push(e)}),b(i.get(n.shift())));return b.each(n,function(t,e){a=a.add(i.get(e))}),a},$:function(t){return this.jQuery.apply(this,Utils.array(arguments))}},b.each(_events,function(t,e){var i=/_/.test(e)?e.replace(/_/g,""):e;w[e.toUpperCase()]="galleria."+i}),b.extend(w,{IE9:9===E,IE8:8===E,IE7:7===E,IE6:6===E,IE:E,WEBKIT:/webkit/.test(e),CHROME:/chrome/.test(e),SAFARI:/safari/.test(e)&&!/chrome/.test(e),QUIRK:E&&x.compatMode&&"BackCompat"===x.compatMode,MAC:/mac/.test(navigator.platform.toLowerCase()),OPERA:!!y.opera,IPHONE:/iphone/.test(e),IPAD:/ipad/.test(e),ANDROID:/android/.test(e),TOUCH:"ontouchstart"in x&&H}),w.addTheme=function(i){i.name||w.raise("No theme name specified"),(!i.version||parseInt(10*w.version)>parseInt(10*i.version))&&w.raise("This version of Galleria requires "+i.name+" theme version "+parseInt(10*w.version)/10+" or later",!0),"object"!=typeof i.defaults?i.defaults={}:i.defaults=_legacyOptions(i.defaults);var n,a,o=!1;return"string"==typeof i.css?(b("link").each(function(t,e){if((n=new RegExp(s(i.css))).test(e.href))return o=!0,_themeLoad(i),!1}),o||b(function(){function t(){b("script").each(function(t,e){n=new RegExp("galleria\\."+i.name.toLowerCase()+"\\."),a=new RegExp("galleria\\.io\\/theme\\/"+i.name.toLowerCase()+"\\/(\\d*\\.*)?(\\d*\\.*)?(\\d*\\/)?js"),(n.test(e.src)||a.test(e.src))&&(o=e.src.replace(/[^\/]*$/,"")+i.css,y.setTimeout(function(){Utils.loadCSS(o,"galleria-theme-"+i.name,function(){_themeLoad(i)})},1))}),o||(5<e++?w.raise("No theme CSS loaded"):y.setTimeout(t,500))}var e=0;t()})):_themeLoad(i),i},w.loadTheme=function(t,e){var i,n;if(!b("script").filter(function(){return b(this).attr("src")==t}).length)return i=!1,b(y).on("load",function(){i||(n=y.setTimeout(function(){i||w.raise("Galleria had problems loading theme at "+t+". Please check theme path or load manually.",!0)},2e4))}),Utils.loadScript(t,function(){i=!0,y.clearTimeout(n)}),w},w.get=function(t){return _instances[t]||("number"!=typeof t?_instances:void w.raise("Gallery index "+t+" not found"))},w.configure=function(t,e){var i={};return"string"==typeof t&&e?(i[t]=e,t=i):b.extend(i,t),w.configure.options=i,b.each(w.get(),function(t,e){e.setOptions(i)}),w},w.configure.options={},w.on=function(i,n){var a;if(i)return a=i+(n=n||r).toString().replace(/\s/g,"")+Utils.timestamp(),b.each(w.get(),function(t,e){e._binds.push(a),e.bind(i,n)}),w.on.binds.push({type:i,callback:n,hash:a}),w},w.on.binds=[],w.run=function(t,e){return b.isFunction(e)&&(e={extend:e}),b(t||"#galleria").galleria(e),w},w.addTransition=function(t,e){return _transitions.effects[t]=e,w},w.utils=Utils,w.log=function(){var e=Utils.array(arguments);if(!("console"in y&&"log"in y.console))return y.alert(e.join("<br>"));try{return y.console.log.apply(y.console,e)}catch(t){b.each(e,function(){y.console.log(this)})}},w.ready=function(i){return"function"!=typeof i||(b.each(_galleries,function(t,e){i.call(e,e._options)}),w.ready.callbacks.push(i)),w},w.ready.callbacks=[],w.raise=function(t,e){function i(t){var i='<div style="padding:4px;margin:0 0 2px;background:#'+(e?"811":"222")+';">'+(e?"<strong>"+n+": </strong>":"")+t+"</div>";b.each(_instances,function(){var t=this.$("errors"),e=this.$("target");t.length||(e.css("position","relative"),t=this.addElement("errors").appendChild("target","errors").$("errors").css(a)),t.append(i)}),_instances.length||b("<div>").css(b.extend(a,{position:"fixed"})).append(i).appendTo(p().body)}var n=e?"Fatal error":"Error",a={color:"#fff",position:"absolute",top:0,left:0,zIndex:1e5};if(I){if(i(t),e)throw new Error(n+": "+t)}else!e||_hasError||(_hasError=!0,e=!1,i("Gallery could not load."))},w.version=1.61,w.getLoadedThemes=function(){return b.map(_loadedThemes,function(t){return t.name})},w.requires=function(t,e){return e=e||"You need to upgrade Galleria to version "+t+" to use one or more components.",w.version<t&&w.raise(e,!0),w},w.Picture=function(t){this.id=t||null,this.image=null,this.container=Utils.create("galleria-image"),b(this.container).css({overflow:"hidden",position:"relative"}),this.original={width:0,height:0},this.ready=!1,this.isIframe=!1},w.Picture.prototype={cache:{},show:function(){Utils.show(this.image)},hide:function(){Utils.moveOut(this.image)},clear:function(){this.image=null},isCached:function(t){return!!this.cache[t]},preload:function(t){var e,i,n=b(new Image).on("load",(e=t,i=this.cache,function(){i[e]=e}));t.srcset&&n.attr("srcset",t.srcset),t.sizes&&n.attr("sizes",t.sizes),n.attr("src",t)},load:function(i,n,t){var e,a,o,s;if("function"==typeof n&&(t=n,n=null),this.isIframe)return e="if"+(new Date).getTime(),a=this.image=b("<iframe>",{src:i,frameborder:0,id:e,allowfullscreen:!0,css:{visibility:"hidden"}})[0],n&&b(a).css(n),b(this.container).find("iframe,img").remove(),this.container.appendChild(this.image),b("#"+e).on("load",(o=this,s=t,function(){y.setTimeout(function(){b(o.image).css("visibility","visible"),"function"==typeof s&&s.call(o,o)},10)})),this.container;this.image=new Image,w.IE8&&b(this.image).css("filter","inherit"),w.IE||w.CHROME||w.SAFARI||b(this.image).css("image-rendering","optimizequality");var r,l,c,h=!1,u=!1,d=b(this.container),p=b(this.image),g=(r=this,l=t,c=i,function(){function t(){b(this).off("load"),r.original=n||{height:this.height,width:this.width},w.HAS3D&&(this.style.MozTransform=this.style.webkitTransform="translate3d(0,0,0)"),d.append(this),r.cache[c]=c,"function"==typeof l&&y.setTimeout(function(){l.call(r,r)},1)}var e;this.width&&this.height?t.call(this):(e=this,Utils.wait({until:function(){return e.width&&e.height},success:function(){t.call(e)},error:function(){u?w.raise("Could not extract width/height from image: "+e.src+". Traced measures: width:"+e.width+"px, height: "+e.height+"px."):(b(new Image).on("load",g).attr("src",e.src),u=!0)},timeout:100}))});return d.find("iframe,img").remove(),p.css("display","block"),Utils.hide(this.image),b.each("minWidth minHeight maxWidth maxHeight".split(" "),function(t,e){p.css(e,/min/.test(e)?"0":"none")}),p.on("load",g).on("error",function(){var t,e;h?C?b(this).attr("src",C):w.raise("Image not found: "+i):(h=!0,y.setTimeout((t=b(this),e=i,function(){t.attr("src",e+(-1<e.indexOf("?")?"&":"?")+Utils.timestamp())}),50))}),i.srcset&&p.attr("srcset",i.srcset),i.sizes&&p.attr("sizes",i.sizes),p.attr("src",i),this.container},scale:function(c){var h=this;if(c=b.extend({width:0,height:0,min:m,max:m,margin:0,complete:r,position:"center",crop:!1,canvas:!1,iframelimit:m},c),this.isIframe){var t,e,i,n=c.width,a=c.height;c.iframelimit&&((i=A.min(c.iframelimit/n,c.iframelimit/a))<1?(t=n*i,e=a*i,b(this.image).css({top:a/2-e/2,left:n/2-t/2,position:"absolute"})):b(this.image).css({top:0,left:0})),b(this.image).width(t||n).height(e||a).removeAttr("width").removeAttr("height"),b(this.container).width(n).height(a),c.complete.call(h,h);try{this.image.contentWindow&&b(this.image.contentWindow).trigger("resize")}catch(t){}return this.container}if(!this.image)return this.container;var u,d,p,o=b(h.container);return Utils.wait({until:function(){return u=c.width||o.width()||Utils.parseValue(o.css("width")),d=c.height||o.height()||Utils.parseValue(o.css("height")),u&&d},success:function(){function t(t,e,i){var n;return/\%/.test(t)?(n=parseInt(t,10)/100,e=h.image[e]||b(h.image)[e](),A.ceil(-1*e*n+i*n)):Utils.parseValue(t)}var e=(u-2*c.margin)/h.original.width,i=(d-2*c.margin)/h.original.height,n=A.min(e,i),a=A.max(e,i),o={true:a,width:e,height:i,false:n,landscape:h.original.width>h.original.height?a:n,portrait:h.original.width<h.original.height?a:n}[c.crop.toString()],s=(c.max&&(o=A.min(c.max,o)),c.min&&(o=A.max(c.min,o)),b.each(["width","height"],function(t,e){b(h.image)[e](h[e]=h.image[e]=A.round(h.original[e]*o))}),b(h.container).width(u).height(d),c.canvas&&_canvas&&(_canvas.elem.width=h.width,_canvas.elem.height=h.height,e=h.image.src+":"+h.width+"x"+h.height,h.image.src=_canvas.cache[e]||function(t){_canvas.context.drawImage(h.image,0,0,h.original.width*o,h.original.height*o);try{return p=_canvas.elem.toDataURL(),_canvas.length+=p.length,_canvas.cache[t]=p}catch(t){return h.image.src}}(e)),{}),r={},l={top:{top:0},left:{left:0},right:{left:"100%"},bottom:{top:"100%"}};b.each(c.position.toLowerCase().split(" "),function(t,e){s[t?"top":"left"]=e="center"===e?"50%":e}),b.each(s,function(t,e){l.hasOwnProperty(e)&&b.extend(r,l[e])}),s=s.top?b.extend(s,r):r,s=b.extend({top:"50%",left:"50%"},s),b(h.image).css({position:"absolute",top:t(s.top,"height",d),left:t(s.left,"width",u)}),h.show(),h.ready=!0,c.complete.call(h,h)},error:function(){w.raise("Could not scale image: "+h.image.src)},timeout:1e3}),this}},b.extend(b.easing,{galleria:function(t,e,i,n,a){return(e/=a/2)<1?n/2*e*e*e+i:n/2*((e-=2)*e*e+2)+i},galleriaIn:function(t,e,i,n,a){return n*(e/=a)*e+i},galleriaOut:function(t,e,i,n,a){return-n*(e/=a)*(e-2)+i}}),w.Finger=(A.abs,a=w.HAS3D=function(){var t,e,i=x.createElement("p"),n=["webkit","O","ms","Moz",""],a=0,o="transform";for(p().html.insertBefore(i,null);n[a];a++)e=n[a]?n[a]+"Transform":o,void 0!==i.style[e]&&(i.style[e]="translate3d(1px,1px,1px)",t=b(i).css(n[a]?"-"+n[a].toLowerCase()+"-"+o:o));return p().html.removeChild(i),void 0!==t&&0<t.length&&"none"!==t}(),t="RequestAnimationFrame",o=y.requestAnimationFrame||y["webkit"+t]||y["moz"+t]||y["o"+t]||y["ms"+t]||function(t){y.setTimeout(t,1e3/60)},$.prototype={constructor:$,setup:function(){this.width=b(this.elem).width(),this.length=A.ceil(b(this.child).width()/this.width),0!==this.index&&(this.index=A.max(0,A.min(this.index,this.length-1)),this.pos=this.to=-this.width*this.index)},setPosition:function(t){this.pos=t,this.to=t},ontouchstart:function(t){t=t.originalEvent.touches;this.start={pageX:t[0].pageX,pageY:t[0].pageY,time:+new Date},this.isScrolling=null,this.touching=!0,this.deltaX=0,T.on("touchmove",this.ontouchmove),T.on("touchend",this.ontouchend)},ontouchmove:function(t){var e=t.originalEvent.touches;e&&1<e.length||t.scale&&1!==t.scale||(this.deltaX=e[0].pageX-this.start.pageX,null===this.isScrolling&&(this.isScrolling=!!(this.isScrolling||A.abs(this.deltaX)<A.abs(e[0].pageY-this.start.pageY))),this.isScrolling||(t.preventDefault(),this.deltaX/=!this.index&&0<this.deltaX||this.index==this.length-1&&this.deltaX<0?A.abs(this.deltaX)/this.width+1.8:1,this.to=this.deltaX-this.index*this.width),t.stopPropagation())},ontouchend:function(t){this.touching=!1;var e=+new Date-this.start.time<250&&40<A.abs(this.deltaX)||A.abs(this.deltaX)>this.width/2,i=!this.index&&0<this.deltaX||this.index==this.length-1&&this.deltaX<0;this.isScrolling||this.show(this.index+(e&&!i?this.deltaX<0?1:-1:0)),T.off("touchmove",this.ontouchmove),T.off("touchend",this.ontouchend)},show:function(t){t!=this.index?this.config.onchange.call(this,t):this.to=-(t*this.width)},moveTo:function(t){t!=this.index&&(this.pos=this.to=-(t*this.width),this.index=t)},loop:function(){var t=this.to-this.pos,e=1;if(this.width&&t&&(e=A.max(.5,A.min(1.5,A.abs(t/this.width)))),this.touching||A.abs(t)<=1)this.pos=this.to,t=0,this.anim&&!this.touching&&this.config.oncomplete(this.index),this.anim=0,this.easing=this.config.easing;else{this.anim||(this.anim={start:this.pos,time:+new Date,distance:t,factor:e,destination:this.to});t=+new Date-this.anim.time,e=this.config.duration*this.anim.factor;if(e<t||this.anim.destination!=this.to)return this.anim=0,void(this.easing=this.easeout);this.pos=this.easing(null,t,this.anim.start,this.anim.distance,e)}this.setX()}},$),b.fn.galleria=function(t){var e=this.selector;return b(this).length?this.each(function(){b.data(this,"galleria")&&(b.data(this,"galleria").destroy(),b(this).find("*").hide()),b.data(this,"galleria",(new w).init(this,t))}):(b(function(){b(e).length?b(e).galleria(t):w.utils.wait({until:function(){return b(e).length},success:function(){b(e).galleria(t)},error:function(){w.raise('Init failed: Galleria could not find the element "'+e+'".')},timeout:5e3})}),this)},w});